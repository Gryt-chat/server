# WebSocket Voice Chat Server Configuration
# Copy this file to .env and fill in your actual values

# Port clients connect to (optional, defaults to 5000)
# PORT=5000

# Your secure SFU host (WebRTC signaling server)
SFU_WS_HOST="wss://your-sfu-server.com"

# Comma separated list of STUN servers for WebRTC
STUN_SERVERS="stun:stun.l.google.com:19302,stun:stun1.l.google.com:19302"

# Voice capacity ("seats")
# If VOICE_MAX_USERS is not set, the server derives seats from SFU_UDP_PORT_MIN/MAX (max-min+1)
# VOICE_MAX_USERS=200
SFU_UDP_PORT_MIN=10000
SFU_UDP_PORT_MAX=10019

# Display name for the server (optional)
# SERVER_NAME="My Voice Server"

# Websocket allowed origins (use "*" for development, specific domains for production)
CORS_ORIGIN="*"

# Server password for client authentication (optional - leave empty for open server)
# SERVER_PASSWORD="your-secure-server-password"

# Password retry cooldown (optional)
# After N incorrect password attempts (per IP + Gryt user, within the retry window),
# the server will enforce a cooldown before allowing more attempts.
# SERVER_PASSWORD_MAX_RETRIES=5
# SERVER_PASSWORD_RETRY_WINDOW_MS=300000
# SERVER_PASSWORD_RETRY_COOLDOWN_MS=60000

# JWT secret for signing access tokens (REQUIRED in production)
# Generate with: openssl rand -base64 48
JWT_SECRET=change-me-in-production

# Refresh token lifetime in days (default: 7)
# REFRESH_TOKEN_TTL_DAYS=7

# Gryt central authentication (Keycloak / OIDC)
# - required: users must sign in with a Gryt account to join
# - disabled: nobody can join (opt-out mode)
GRYT_AUTH_MODE=required

# Server owner (Gryt user id / Keycloak `sub`)
# If set, the server will persist this value as the owner on startup.
# If missing, the server will run without an owner and NO user will be auto-promoted to owner on first join.
OWNER_ID=

# Keycloak realm issuer URL (used for JWKS + signature verification)
GRYT_OIDC_ISSUER=https://auth.gryt.chat/realms/gryt

# Expected audience/client for the access token (checked against `azp` and/or `aud`)
GRYT_OIDC_AUDIENCE=gryt-web

# ScyllaDB / Cassandra settings
SCYLLA_CONTACT_POINTS=your-scylla-host.com
SCYLLA_LOCAL_DATACENTER=datacenter1
# IMPORTANT: if you run multiple Gryt servers against the same Scylla cluster,
# each server instance MUST use its own keyspace (e.g. ws1, ws2).
SCYLLA_KEYSPACE=your_keyspace_name
SCYLLA_USERNAME=your_scylla_username
SCYLLA_PASSWORD=your_scylla_password

# S3 / Object storage (AWS S3, Cloudflare R2, Wasabi, MinIO)
S3_REGION=auto
S3_ENDPOINT=https://your-s3-endpoint.com
S3_ACCESS_KEY_ID=your_s3_access_key
S3_SECRET_ACCESS_KEY=your_s3_secret_key
S3_BUCKET=your-bucket-name
S3_FORCE_PATH_STYLE=true

# Additional channels configuration (JSON array of channel objects)
ADDITIONAL_CHANNELS=[{"name":"Announcements","type":"text","id":"announcements","description":"Server announcements and important updates"}]

# Example additional channels:
# ADDITIONAL_CHANNELS=[
#   {"name":"General","type":"text","id":"general","description":"General discussion"},
#   {"name":"Voice Chat","type":"voice","id":"voice","description":"Main voice channel"},
#   {"name":"Announcements","type":"text","id":"announcements","description":"Server announcements"}
# ]

# No password - open server
# SERVER_PASSWORD=